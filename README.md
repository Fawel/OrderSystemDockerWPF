# OrderSystemDockerWPF
Баловство для попыток понять докер и потыкать в net.core WPF.

Приложение должно состоять из двух сервисов - Customer и Order. 
Customer отвечает за добавление и удаление покупателей. 
Order - за создание, удаление заказов. 

Собственно взаимодействие с этими сервисами должно осуществляться через WPF приложение.
Оба сервиса должны деплоиься в докер контейнере и иметь свою базу.

Для запуска потребуются:
* Докер
* Net.core 3.1

Для запуска CustomerSystem нужно выполнить docker-compose build в папке с файлом docker-compose.yml.

Краткая справка самому себе.
1) Image (образ) - собственно набор правил по созданию виртуальной машины с определённым набором приложений. Все образы должны наследоваться от базового.
2) Container (контейнер) - конкретная изолированная виртуальная машина созданная на основе некоего образа. Неспособна менять образ. Может пользоваться файлами вне контейнера с помощью mounted папок или volume. Чтобы обращаться извне нужно прокидывать порты.
3) Два запущенных контейнера не видят друг друга если запущенны в локалхосте, даже если вручную можно достучаться до каждого.
Нужно использовать docker-compose
4) docker-compose - система группировки контейнеров, через которую проще можно пропихнуть параметры окружения и выполнить одновременный запуск нескольких контейнеров, а также наладить связь между ними.
5) Контекст для контейнера при настройке dockerfile распространяется только на текущий уровень папки и ниже, подняться выше нельзя. Это означает что при наличии Shared сервисов либо они все должны находиться в одной папке, либо dockerfile должен находится "выше" по уровню, чтобы было возможно скопировать все нужные зависимые локальные либы
6) Для добавления поддержки докера в не-докер проекте, в студии можно ткнуть правой кнопкой на проект, "Добавить/Поддержка Docker" (интересно, можно ли это сделать через CLI?)
7) Если нужно несколько контейнеров и соот-но docker-compose, то его поддержку можно добавить ткнув правой на проекта, "Добавить/Поддержка оркестратора контейнеров" (интересно, можно ли это сделать через CLI?). В солюшене добавится новый проект, его настройки можно посмотреть в файле с расширением .dcproj (дефолтное имя - docker-compose.dcproj)
8) По дефолту оркестратор жрёт только файлы вида docker-compose.yml и производные (..override.yml, файлы для разных конфигураций). Если у docker-compose.yml другое имя, то нужно поменять в .dcproj файле имя вашего .yml, плюс добавить параметр <DockerComposeBaseFilePath>, иначе глупая студия будет пытаться жрать дефолтное название файла и постоянно падать
9) Если нужно поменять имя самого оркестратора для студии (.dcproj) не забудьте поменять его название также в .sln файле, если таковой есть
10) Для дебага проектов в оркестраторе, запускаем оркестратор, заходим в окно "Контейнеры" в студии (Вид\Другие окна\Контейнеры) и там выбираем нужный контейнер с нашей прогой и тыфкаем на кнопку "Присоединиться к процессу". Теперь мы могём дебажить, ура
11) В окне "Контейнеры" так же можно войти в контейнер, нажав кнопку "Открыть окно терминала". По дефолту откроется новое cmd окно (полагаю это можно настроить?). Альтернативно предлагают поставить расширение для студии для показа терминала внутри студии (https://marketplace.visualstudio.com/items?itemName=dos-cafe.WhackWhackTerminal).
